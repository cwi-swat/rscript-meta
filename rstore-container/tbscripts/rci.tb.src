#ifndef __RCI_
#define __RCI_

process StartRCI is
  snd-msg(load-jar("file://__PKGDATA__/rstore-container.jar", "__PKGDATA__/relationstores.jar:__PKGDATA__/log4j-1.2.14.jar:__PKGDATA__/commons-logging-1.1.jar:__EXTERNAL_JARS__"))

tool rStoreContainer is {}

/**
 * The RStore Container Interface (RCI) toolbus process
 *
 * @author Ricardo Lindooren
 * @author Arend van Beelen (reviewer)
 * @date 13-02-2006
 */
process RCI-TEST is
  let Container: rStoreContainer,
      Path: str,
      RStoreId: int,
      RStoreFacts: list,
      FactId: int,
      FactData: term
  in
    printf("[RCI] START\n") .

    rec-connect(Container?)
    ||
    (
      (
        (
          printf("[RCI] Waiting to receive RStore Path message\n")

          // Wait for command from Factbrowser Managment Proces to load RStore File
          . rec-msg(rc-load-rstore(Path?))

          // Tell Java RStoreContainer tool to Load the RStore file
          . snd-eval(Container, rc-load-rstore(Path))

          // Wait for identifier for loaded RStore file
          . rec-value(Container, rc-rstore-loaded(Path?, RStoreId?))

          // Send RStoreId MSG to Factbrowser Managment Proces
          . snd-msg(rc-rstore-loaded(Path, RStoreId))
        )
        *
        delta
      )
    ||
      (
        (
          printf("[RCI] Waiting to receive RStore ID message\n")

          // Wait for command from Factbrowser Managment Proces to retrieve RStore facts based on a RStoreId
          . rec-msg(rc-get-rstore-facts(RStoreId?))

          // Tell the Java RStoreContainer tool to load the fact information for the Rstore with the given ID
          . snd-eval(Container, rc-get-rstore-facts(RStoreId))

          // Wait for the facts retrieved by the RStoreContainer
          . rec-value(Container, rc-rstore-facts(RStoreFacts?))

          // Send RStore facts
          . snd-msg(rc-get-rstore-facts(RStoreId, RStoreFacts))
        )
        *
        delta
      )
    ||
      (
        (
          printf("[RCI] Waiting to receive Fact ID message\n")

          // Wait for the Factbrowser-command to load data from a specific fact
          . rec-msg(rc-get-fact-data(RStoreId?, FactId?))

          // Tell the Java RStoreContainer tool to load the Fact data
          . snd-eval(Container, rc-get-fact-data(RStoreId, FactId))

          // Wait for the Fact data loaded by the RStoreContainer
          . rec-value(Container, rc-fact-data(FactData?))

          // Send the Fact data to the Factbrowser
          . snd-msg(rc-get-fact-data(RStoreId, FactId, FactData)) // aangepast
        )
        *
        delta
      )
    )
  endlet

toolbus(RCI())
<<<<<<< .mine
toolbus(StartRCI)
//toolbus(RCITEST())
=======
>>>>>>> .r214

#endif /* __RCI_ */
